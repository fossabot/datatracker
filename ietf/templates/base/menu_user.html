{# Copyright The IETF Trust 2015, All Rights Reserved #}
{% load origin %}
{% origin %}
{% load ietf_filters %}
<li class="nav-item dropdown">
    {% if flavor == "top" %}
        <a href="#"
           class="nav-link dropdown-toggle{% if user.person.photo_thumb %} p-0{% endif %}"
           role="button"
           data-bs-toggle="dropdown"
           aria-expanded="false">
            {% if user.is_authenticated %}
                {% if user.person.photo_thumb %}
                    <img class="user-photo rounded-circle ms-1"
                         width="40"
                         height="40"
                         src="{{ user.person.photo_thumb.url }}"
                         alt="Photo of {{ user.person.name }}">
                {% else %}
                    {{ user.username|split:'@'|first }}
                {% endif %}
            {% else %}
                User
            {% endif %}
        </a>
        <ul class="dropdown-menu {% if flavor == 'top' %} mt-n1 {% else %} ms-n1 {% endif %}">
        {% else %}
            <span class="fw-bolder">User</span>
        </li>
    {% endif %}
    {% url 'django.contrib.auth.views.logout' as logout_url %}
    {% if request.get_full_path == logout_url %}
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               rel="nofollow"
               href="{% url 'ietf.ietfauth.views.login' %}">
                Sign in
            </a>
        </li>
    {% else %}
        {% if user.is_authenticated %}
            <li>
                <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
                   rel="nofollow"
                   href="{% url 'django.contrib.auth.views.logout' %}">
                    Sign out
                </a>
            </li>
            <li>
                <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
                   rel="nofollow"
                   href="{% url 'ietf.ietfauth.views.profile' %}">
                    Account info
                </a>
            </li>
            {% if user and user.person %}
                <li>
                    <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
                       href="{% url 'ietf.person.views.profile' email_or_name=user.person.name %}">
                        Public profile page
                    </a>
                </li>
            {% endif %}
            <li>
                <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
                   href="{% url 'ietf.cookies.views.preferences' %}"
                   rel="nofollow">
                    Preferences
                </a>
            </li>
            <li>
                <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
                   href="{% url 'ietf.ietfauth.views.apikey_index' %}"
                   rel="nofollow">
                    API keys
                </a>
            </li>
            <li>
                <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
                   rel="nofollow"
                   href="{% url 'ietf.ietfauth.views.change_password' %}">
                    Change password
                </a>
            </li>
            <li>
                <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
                   rel="nofollow"
                   href="{% url 'ietf.ietfauth.views.change_username' %}">
                    Change username
                </a>
            </li>
        {% else %}
            <li>
                <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
                   rel="nofollow"
                   href="{% url 'ietf.ietfauth.views.login' %}?next={{ request.get_full_path|urlencode }}">
                    Sign in
                </a>
            </li>
            <li>
                <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
                   rel="nofollow"
                   href="{% url 'ietf.ietfauth.views.password_reset' %}">
                    Password reset
                </a>
            </li>
            <li>
                <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
                   href="{% url 'ietf.cookies.views.preferences' %}"
                   rel="nofollow">
                    Preferences
                </a>
            </li>
        {% endif %}
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'personal-information' %}">
                Handling of personal information
            </a>
        </li>
    {% endif %}
    {% if not request.user.is_authenticated %}
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.ietfauth.views.create_account' %}">
                New account
            </a>
        </li>
    {% endif %}
    {% if user|has_role:"Reviewer" %}
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.ietfauth.views.review_overview' %}">
                My reviews
            </a>
        </li>
    {% endif %}
    {% if user|has_role:"Area Director" %}
        {% if flavor == "top" %}
            <li>
                <hr class="dropdown-divider">
            </li>
        {% endif %}
        <li {% if flavor == "top" %}class="dropdown-header"{% else %}class="nav-item fw-bolder"{% endif %}>AD dashboard</li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.doc.views_search.docs_for_ad' name=user.person.full_name_as_key %}">
                My docs
            </a>
        </li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.iesg.views.agenda_documents' %}">
                Next telechat
            </a>
        </li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.iesg.views.discusses' %}">
                Discusses
            </a>
        </li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.iesg.views.milestones_needing_review' %}">
                Milestone review
            </a>
        </li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.doc.views_search.drafts_in_last_call' %}">
                Last Call docs
            </a>
        </li>
    {% endif %}
    {% if user|has_role:"Secretariat" %}
        {% if flavor == "top" %}
            <li>
                <hr class="dropdown-divider">
            </li>
        {% endif %}
        <li {% if flavor == 'top' %}class="dropdown-header"{% else %}class="nav-item fw-bolder"{% endif %}>
            IETF secretariat
        </li>
        <li class="dropend group-menu">
            <a class="dropdown-item dropdown-toggle {% if flavor != 'top' %}text-wrap link-primary{% endif %}"
               href="#">IESG</a>
            <ul class="dropdown-menu ms-n1{% if flavor == 'top' %} mt-n1{% endif %}">
                <li>
                    <a class="dropdown-item"
                       href="{% url 'ietf.secr.announcement.views.main' %}">Announcement</a>
                </li>
                <li>
                    <a class="dropdown-item"
                       href="{% url 'ietf.secr.telechat.views.main' %}">Telechat</a>
                </li>
                <li>
                    <a class="dropdown-item" href="{% url 'ietf.secr.console.views.main' %}">Console</a>
                </li>
                <li>
                    <a class="dropdown-item"
                       href="{% url 'admin:iesg_telechatdate_changelist' %}">
                        Telechat dates
                    </a>
                </li>
                <li>
                    <a class="dropdown-item"
                       href="{% url 'admin:iesg_telechatagendaitem_changelist' %}">
                        Management items
                    </a>
                </li>
            </ul>
        </li>
        <li class="dropend group-menu">
            <a class="dropdown-item dropdown-toggle {% if flavor != 'top' %}text-wrap link-primary{% endif %}"
               href="#">
                IDs &amp; WGs
            </a>
            <ul class="dropdown-menu ms-n1{% if flavor == 'top' %} mt-n1{% endif %}">
                <li>
                    <a class="dropdown-item"
                       href="{% url "ietf.secr.areas.views.list_areas" %}">Areas</a>
                </li>
                <li>
                    <a class="dropdown-item"
                       href="{% url 'ietf.secr.groups.views.search' %}">Groups</a>
                </li>
                <li>
                    <a class="dropdown-item"
                       href="{% url 'ietf.secr.rolodex.views.search' %}">Rolodex</a>
                </li>
                <li>
                    <a class="dropdown-item" href="{% url 'ietf.secr.roles.views.main' %}">Roles</a>
                </li>
            </ul>
        </li>
        <li class="dropend group-menu">
            <a class="dropdown-item dropdown-toggle {% if flavor != 'top' %}text-wrap link-primary{% endif %}"
               href="#">
                Meetings &amp; Proceedings
            </a>
            <ul class="dropdown-menu ms-n1{% if flavor == 'top' %} mt-n1{% endif %}">
                <li>
                    <a class="dropdown-item" href="{% url "ietf.secr.sreq.views.main" %}">Session Requests</a>
                </li>
                <li>
                    <a class="dropdown-item"
                       href="{% url 'ietf.secr.proceedings.views.main' %}">Meeting Materials Manager (Proceedings)</a>
                </li>
                <li>
                    <a class="dropdown-item"
                       href="{% url "ietf.secr.meetings.views.main" %}">Meeting Manager</a>
                </li>
                <li>
                    <a class="dropdown-item"
                       href="{% url "ietf.secr.meetings.views.blue_sheet_redirect" %}">Blue Sheets</a>
                </li>
            </ul>
        </li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.ipr.views.admin' state='pending' %}">IPR Admin</a>
        </li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.iesg.views.milestones_needing_review' %}">
                Milestones
            </a>
        </li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.sync.views.discrepancies' %}">
                Sync discrepancies
            </a>
        </li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.ietfauth.views.add_account_whitelist' %}">
                Account whitelist
            </a>
        </li>
    {% endif %}
    {% if user|has_role:"IANA" %}
        {% if flavor == "top" %}
            <li>
                <hr class="dropdown-divider">
            </li>
        {% endif %}
        <li {% if flavor == "top" %}class="dropdown-header"{% else %}class="nav-item fw-bolder"{% endif %}>
            IANA
        </li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.sync.views.discrepancies' %}">
                Sync discrepancies
            </a>
        </li>
    {% endif %}
    {% if user|has_role:"RFC Editor" %}
        {% if flavor == "top" %}
            <li>
                <hr class="dropdown-divider">
            </li>
        {% endif %}
        <li {% if flavor == "top" %}class="dropdown-header"{% else %}class="nav-item fw-bolder"{% endif %}>
            RFC Editor
        </li>
        <li>
            <a class="dropdown-item {% if flavor != 'top' %} text-wrap link-primary{% endif %}"
               href="{% url 'ietf.sync.views.discrepancies' %}">
                Sync discrepancies
            </a>
        </li>
    {% endif %}
    {% if flavor == "top" %}
    </ul>
</li>
{% endif %}